<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…ÛŒÙ†ÛŒâ€ŒØ§Ù¾ NFT ØªÙ„Ú¯Ø±Ø§Ù…</title>
  <style>
    body { font-family: sans-serif; direction: rtl; text-align: center; padding: 20px; background: #f0f8ff; }
    #userInfo { margin-bottom: 10px; }
    .nft-card { display: inline-block; margin: 10px; border: 2px solid #333; border-radius: 10px; padding: 10px; width: 150px; }
    .nft-card img { width: 100%; border-radius: 10px; }
    button { margin-top: 5px; padding: 8px 12px; border-radius: 6px; border: none; background-color: #00796b; color: #fff; cursor: pointer; }
  </style>
</head>
<body>

<h2>ğŸ¨ ÙØ±ÙˆØ´ NFT Ø¯Ø± ØªÙ„Ú¯Ø±Ø§Ù…</h2>
<p id="userInfo">Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±...</p>
<div id="nftContainer"></div>

<button id="connectBtn">Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ TON</button>

<script src="https://unpkg.com/tonconnect/dist/tonconnect.min.js"></script>
<script>
const tg = window.Telegram?.WebApp;
const userInfo = document.getElementById('userInfo');
if(tg){
  const user = tg.initDataUnsafe?.user || tg.initData?.user;
  userInfo.innerText = user
    ? `Ú©Ø§Ø±Ø¨Ø±: ${user.first_name || ''} ${user.last_name || ''} â€“ @${user.username || ''}`
    : 'Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª.';
}else{
  userInfo.innerText = 'Ø§ÛŒÙ† ØµÙØ­Ù‡ Ø¨Ø§ÛŒØ¯ Ø§Ø² Ø¯Ø§Ø®Ù„ ØªÙ„Ú¯Ø±Ø§Ù… Ø¨Ø§Ø² Ø´ÙˆØ¯.';
}

// Ù†Ù…ÙˆÙ†Ù‡ NFTÙ‡Ø§
const nftData = [
  { id: 1, name: "NFT Ø¢Ø¨ÛŒ", image: "https://via.placeholder.com/150/2196f3/ffffff?text=NFT+1", price: 5.0 },
  { id: 2, name: "NFT Ø³Ø¨Ø²", image: "https://via.placeholder.com/150/4caf50/ffffff?text=NFT+2", price: 3.5 },
  { id: 3, name: "NFT Ù‚Ø±Ù…Ø²", image: "https://via.placeholder.com/150/f44336/ffffff?text=NFT+3", price: 7.0 }
];

const nftContainer = document.getElementById('nftContainer');
nftData.forEach(nft => {
  const card = document.createElement('div');
  card.className = 'nft-card';
  card.innerHTML = `<img src="${nft.image}" alt="${nft.name}"><p>${nft.name}</p><p>${nft.price} TON</p><button onclick="buyNFT(${nft.id}, ${nft.price})">Ø®Ø±ÛŒØ¯</button>`;
  nftContainer.appendChild(card);
});

// Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ TON
let wallet;
const tonConnect = new TonConnect.TonConnect();
document.getElementById('connectBtn').addEventListener('click', async () => {
  await tonConnect.connect();
  wallet = tonConnect.wallet;
  alert(`Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù…ØªØµÙ„ Ø´Ø¯: ${wallet?.name || wallet?.address}`);
});

// Ø®Ø±ÛŒØ¯ NFT
async function buyNFT(nftId, nftPrice){
  if(!wallet){
    alert("Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØµÙ„ Ú©Ù†ÛŒØ¯.");
    return;
  }
  const buyAmount = nftPrice + 1.0; // Ù‚ÛŒÙ…Øª NFT + 1 TON Ø§Ø¶Ø§ÙÛŒ
  const transaction = {
    validUntil: Math.floor(Date.now() / 1000) + 360,
    messages: [
      {
        address: "0:your_contract_address_here", // Ø¢Ø¯Ø±Ø³ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ ÙØ±ÙˆØ´ NFT
        amount: buyAmount * 1e9 // ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ù†Ø§Ù†Ùˆ
      }
    ]
  };
  try {
    await tonConnect.sendTransaction(transaction);
    alert(`NFT ${nftId} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯!`);
  } catch (error) {
    alert("Ø®Ø·Ø§ Ø¯Ø± Ø§Ù†Ø¬Ø§Ù… ØªØ±Ø§Ú©Ù†Ø´: " + error.message);
  }
}
</script>

</body>
</html>
